!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.RedPacket=t(e)}(this,function(e){"use strict";function a(e,t){var i=Math.random()*(t-e+1)+e;return parseFloat(i.toFixed(2))}function t(e,t){if(e&&(this.ele=/^#/.test(e)?document.getElementById(e.replace(/#/,"")):document.getElementsByClassName(e.replace(/\./,""))[0],this.ele)){this.opt=t||{};var i=document.createElement("div");i.className="red-packet",i.style.width="100%",i.style.height="100%",this.ele.appendChild(i),this.ele=i,this._RED_PACKET_BOX=[],this._TIME=null}}return t.prototype={createElement:function(){var e=document.createElement("div");return e.className="red-pack-item "+this.opt.addClass,e},itemAppend:function(e){var t=e.ele;t.style.left=e.x+"px",t.style.top=e.y+"px",this.ele.appendChild(t)},generateRedPack:function(e,t){this.boxInfo={width:this.ele.offsetWidth,height:this.ele.offsetHeight};for(var i=e||this.opt.density||100,s=this.opt.speed||4,n=this.boxInfo.width/i,o=0;o<n;o++){var h={ele:this.createElement(),x:a(o*i,(o+1)*i),y:a(-i,0),speed:a(s-.2,s+.2)};this.itemAppend(h),this._RED_PACKET_BOX.push(h)}this.renPackLen=this._RED_PACKET_BOX.length,"function"==typeof t&&t()},renPackLen:0,movePos:0,isRedPack:!1,move:function(){var o=this;this._TIME=setInterval(function(){var e=o.renPackLen;o.movePos+=o.opt.speed,o.isRedPack=!0;for(var t=0;t<e;t++){var i=o._RED_PACKET_BOX[t],s=i.speed,n=i.ele;i.x=i.x-s/6,i.y=i.y+s,n.style.left=i.x+"px",n.style.top=i.y+"px",i.y>=o.boxInfo.height&&(n.parentNode.removeChild(n),o._RED_PACKET_BOX.splice(t,1),o.renPackLen--,t--,e--)}o.movePos>=o.opt.density&&(o.generateRedPack(),o.movePos=0)},1e3/60)},start:function(e){var t=this;this.isStop?(this.isStop=!1,this.move()):(this.destroy(),this.ele.style.display="block",this.generateRedPack(null,function(){t.move()})),"function"==typeof e&&e()},isStop:!1,stop:function(){clearInterval(this._TIME),this._TIME=null,this.isStop=!0},destroy:function(){clearInterval(this._TIME),this._TIME=null,this.isStop=!0,this._RED_PACKET_BOX=[],this.ele.innerHTML="",this.movePos=0,this.renPackLen=0,this.ele.style.display="none",this.isStop=!1,this.isRedPack=!1}},t});